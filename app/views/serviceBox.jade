extends layout

block content
  header
  
    nav.navbar
      div.container-fluid
        div.navbar-header
          button.navbar-toggle.collapsed(type="button", data-toggle="collapse", data-target="#nav1", aria-expanded="false", aria-controls="navbar")
            span.sr-only Toggle navigation
            span.icon-bar
            span.icon-bar
            span.icon-bar
          a.navbar-brand(href="/") Banco de la República Costarricense
        #nav1.collapse.navbar-collapse
          ul.nav.navbar-nav.pull-right
            li.active: a.f-nav.dropdown-toggle( href="/" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false") Lista de Clientes
              span.caret
              ul.dropdown-menu
                li: a(href="serviceBoxList") Lista de Cajas
                li: a(href="servicePlatformList") Lista de Plataforma
                li: a(href="serviceCreditList") Lista de Crédito
                li: a(href="serviceMarchamoList") Lista de Marchamo
                li: a(href="serviceDisabledPeopleList") Lista de Personas con Discapacidad
            li: a.f-nav( href="/service") Servicios

    div.container
      div.row
        div.col-md-12
          h1 Cajas
          - var attend = ""
          -for (var i=0; i< fichas.length;i++){
            if fichas[i].atendido == false
              -var attend="No"
            else
              -var attend="Si"
              
            if fichas[i].Atendido = True
              table#tablehi.none(class=fichas[i].Atendido = True ? "" : "in") 
            else            
              table.table.table-bordered
                tr.table-clients
                  th Id de tiquete
                  th Tiquete
                  th Tipo de tiquete
                  th Atendido 
                  th Acción
                  th Timer
                tr
                  td #{fichas[i]._id}
                  td #{fichas[i].ticket}
                  td #{fichas[i].nombreDeCaja}
                  td=attend
                  td 
                    button.btn.btn-default(id="start", onclick="timer()") Empezar
                    form(id="changeAttendState", method="post", action="/serviceBoxList/#{fichas[i]._id}")
                      input.attendBtn(type="submit", name="idFicha", id="stop", value="Terminar")    

                  td 
                    p 00:00:00
            -}
    
        script.
          var p = document.getElementsByTagName('p')[0];
          var start = document.getElementById('start');
          var stop = document.getElementById('stop');
          var seconds = 0, minutes = 0, hours = 0;
          var t;
          var totalTime;
          
          function add() {
            seconds++;
            if (seconds >= 60) {
                seconds = 0;
                minutes++;
                if (minutes >= 60) {
                  minutes = 0;
                  hours++;
                }
            }
            p.textContent = (hours ? (hours > 9 ? hours : "0" + hours) : "00") + ":" + (minutes ? (minutes > 9 ? minutes : "0" + minutes) : "00") + ":" + (seconds > 9 ? seconds : "0" + seconds);

            timer();
          }
          function timer() {
            t = setTimeout(add, 1000);
            totalTime = seconds + '  ' + minutes;
            
            console.log('total ',totalTime);
          }
          /* Start button */
          start.onclick = timer;

          /* Stop button */
          stop.onclick = function() {
              clearTimeout(t);
          }
          
